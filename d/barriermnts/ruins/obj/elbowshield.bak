#include <std.h>
#include "../inherit/ruins.h"
inherit ARMOUR;

void create() {
   ::create();
   set_name("elbow shield");
   set_short("%^RESET%^%^ORANGE%^rogue's barrier%^RESET%^");
   set_obvious_short("%^RESET%^%^ORANGE%^small circular shield%^RESET%^");
   set_id(({"shield","elbow shield","Shield","rogue shield","leather shield","barrier","rogue's 
barrier"}));
   set_long("%^CYAN%^This shield could barely even be classified as that - it is even smaller than a "
"buckler, and perfectly circular.  %^ORANGE%^Treated leather%^CYAN%^ forms the base of the shield, set "
"with a single %^WHITE%^mi%^BLACK%^%^BOLD%^t%^RESET%^%^WHITE%^hr%^BLACK%^%^BOLD%^i%^RESET%^%^WHITE%^l "
"pl%^BLACK%^%^BOLD%^a%^RESET%^%^WHITE%^te%^CYAN%^ covering the outer edge.  Two sturdy %^ORANGE%^leather "
"straps%^CYAN%^ would hold it upon the wearer's arm, though they are fitted so that the shield would be "
"more comfortable to wear over the elbow, rather than further down the arm.  How they would manage to "
"defend the wearer in such a position is anyone's guess.%^RESET%^\n");
   set_weight(8);
   set_value(430);
   set_type("thiefshield");
   set_ac(0);
   set_size(2);
   set_lore("%^WHITE%^%^BOLD%^This unique shield was devised for combat by the rogue known only in lore "
"as Eylean.  Many accounts of his battles claim he could use the tiny shield to defend himself, as "
"effectively as a warrior would use a full body shield.%^RESET%^\n");
   set_property("lore difficulty",15);
   set_property("enchantment",1);
   set_limbs(({"right arm"}));
   set_wear((:TO,"wear_fun":));
   set_remove((:TO,"remove_fun":));
   set_struck((:TO,"struck_fun":));
}

int wear_fun() {
   if((int)ETO->query_lowest_level() < 18) {
     tell_object(ETO,"%^WHITE%^%^BOLD%^You can't make sense of how to use the shield!%^RESET%^");
     tell_room(EETO,"%^WHITE%^%^BOLD%^"+ETO->QCN+" can't seem to make sense of how to wear the "
"shield!%^RESET%^",ETO);
     return 0;
   }
   if(ETO->is_class("thief") && sizeof(TP->query_classes()) == 1) {
     tell_object(ETO,"%^ORANGE%^You strap the shield securely over your right elbow.%^RESET%^");
     tell_room(EETO,"%^ORANGE%^"+ETO->QCN+" straps the shield securely over "+ETO->QP+" right "
"elbow.%^RESET%^",ETO);
     return 1;
   }
   tell_object(ETO,"%^WHITE%^%^BOLD%^You can't make sense of how to use the shield!%^RESET%^");
   tell_room(EETO,"%^WHITE%^%^BOLD%^"+ETO->QCN+" can't seem to make sense of how to wear the "
"shield!%^RESET%^",ETO);
   return 0;
}

int remove_fun() {
   tell_object(ETO,"%^ORANGE%^You unstrap the small shield from your arm.%^RESET%^");
   tell_room(EETO,"%^ORANGE%^"+ETO->QCN+" unstraps the small shield from "+ETO->QP+" arm.%^RESET%^",ETO);
   return 1;
}

int struck_fun(int damage, object what, object target) {
   if (!random(2)) {
     tell_object(ETO,"%^ORANGE%^You swing your elbow up, and deflect "+target->QCN+"'s attack with your "
"shield!%^RESET%^");
     tell_object(target,"%^ORANGE%^"+ETO->QCN+" swings "+ETO->QP+" elbow up, and deflects your attack "
"with "+ETO->QP+" shield!%^RESET%^");
     tell_room(EETO,"%^ORANGE%^"+ETO->QCN+" swings "+ETO->QP+" elbow up, and deflects "+target->QCN+"'s attack with "+ETO->QP+" shield!%^RESET%^",({ETO,target}));
     return (-1)*damage;
   }
   return 1;
}
