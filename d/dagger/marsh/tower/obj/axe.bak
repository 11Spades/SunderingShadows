#include <std.h>
inherit "std/weapon";
int uses;
object owned;
void init() {
    ::init();
    if(interactive(TP) && !owned) owned = TPQN;
}
void create() {
    ::create();
    set_name("axe");
    set_id(({
        "axe","two handed axe","battle axe"
    }));
    set_short("%^RESET%^%^RED%^Battle axe of Bloodlust%^RESET%^");
    set_long(
   	"%^RED%^This is an extremly fine crafted battle axe, meant to be wielded in "
	"two hands in a wildly crazed swinging fashion during battle. It is covered with glowing runic "
	"inscriptions of battle lore and appears highly magical. It's hilt is covered in fine jewels."
        "%^RESET%^"
    );
    set_weight(30);
    set_size(3);
    set("value",1000);
    set_wc(1,8);
    set_large_wc(1,8);
    set_type("slashing");
    set_hit((: TO, "extra_hit":));
    set_wield((: TO, "extra_wield":));
    set_property("enchantment",3);
    uses = random(100)+7;
    set_prof_type("large axe");
}
int extra_hit(object ob) {
    object vic;
    int dam,cycle,amnt;
    vic = ETO->query_current_attacker();
    if(random(6) < 4) return 1;
    if((string)ETO->query_name() == "istvan") {
	for(cycle=0;cycle<2;cycle++) {
	    message("my_action",
	        "%^BOLD%^%^BLUE%^The %^GREEN%^battle axe%^BLUE%^ uses the power of the marsh "
	        "deliver a smashing wound to "
	        +vic->query_cap_name()+"!%^RESET%^"
            ,ETO);
            message("other_action",
	        "%^BOLD%^%^BLUE%^The %^GREEN%^battle axe%^BLUE%^ wielded by "+ETO->query_cap_name()+
	        " screams with blood filled energy as it slices into the flesh of "
	        +vic->query_cap_name()+"!"
    	    ,environment(vic),(({ETO, vic})));
            message("my_action",
                "%^BOLD%^%^BLUE%^The %^GREEN%^battle axe%^BLUE%^ wielded by "+ETO->query_cap_name()+
	        " screams with blood filled energy as it slices deep into your flesh!%^RESET%^"
            ,vic);
	    amnt = random(10)+10;
	    vic->do_damage(vic->return_target_limb(),amnt);
        }
   }
    if (uses < 1) {
        dam = random(1)+1;	    
    } else {  
            message("my_action",
	        "%^RED%^The battle axe of bloodlust delivers a stunning blow!%^RESET%^"
            ,ETO);
            message("my_action",
                "%^RED%^The battle axe of bloodlust delivers a stunning blow!%^RESET%^"
            ,vic);
	    dam = random(5)+3;
            if(random(100) < 20) {
	        vic->set_paralyzed(dam,"You are stunned by the blow!");
		uses = uses - 3;
	    }
	    uses = uses - 1;
    }
    return dam;
}
int extra_wield() {
    object tp;
    tp = this_player();
    if (!tp) return 0;
    if((int)tp->query_level() < 25) {
	write("You could not control the power this weapon can deliver!");
	return 0;
    }
    if((string)TP->query_name() != owned && (string)TP->query_name() != "istvan") {
	write("The axe fails to bond with you and vanishes!");
        TO->remove();
        return 0;
    }
    if(uses > 0) {
        write(
	    "%^RESET%^%^MAGENTA%^You say: %^RESET%^Time to slice, dice and mutilate mice!"
        );
        say(
	    "%^RESET%^%^MAGENTA%^"+ETO->query_cap_name()+" says: %^RESET%^Time to slice, dice and mutilate mice!"
        ,ETO);
        return 1;
    } else {
	return 1;
    }
}
