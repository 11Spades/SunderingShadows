
#include <std.h>

inherit MONSTER;

object bl, master, orig;
int stay;

int restat();
void set_master(object mast);
void set_orig(object ob);

void create(){
        object ob;
        ::create();
        set_name("Sword of Dancing");
        set_race("sword");
        set_id(({"sword","sword of dancing","dancing"}));
        set("short","Sword of Dancing");
        set("long",
@DARKWOOD
This is a dancing Sword of Dancing.  Watch yourself!
 
DARKWOOD
        );
        set_hd(8,1);
        set_hp(300000000);
        set_exp(10);
        set_class("fighter");
        set_body_type("humanoid");
        set_wielding_limbs(({"right hand","left and"}));
        bl=new("/d/darkwood/equip/dance_blade");
        bl->move(TO);
        command("wield blade");
        stay = 1;
}

int stop_dancing() {
  say("The Blade stops dancing and returns to its master.");
  set_hp(-1000000);
  stay = 0;
  orig->move(master); 
  return 1;
}

void set_master(object mast) { master = mast; }

void set_orig(object ob) { orig = ob; }

int restat() {
        if(!master) return 0;
        set_hd(master->query_level(),1);
        set_level(master->query_level());
        kill_ob(master->query_current_attacker(),1);
        return 1;
}

heart_beat() {
  ::heart_beat();
  if(!present("blade", TO)) {
    if(present(master, environment(TO))) {
      orig->move(master); 
      say("The dancing Sword of Dancing returns to its master.");
    }
    else {
      say("The dancing Sword of Dancing falls to the ground.");
      orig->move(environment(TO));
    }
    set_heart_beat(0);
    TO->remove();
    return;
  }
}

